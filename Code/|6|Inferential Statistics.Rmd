---
title: "Inferentials"
output: html_document
---

```{r}
library(tidyverse)
library(performance)
library(lme4)
library(lattice) # Lattice/pannel plots
library(ggplot2) # Some nice grahics
library(stringi) # install before HLMdiag or HLMdiag won't load properly library(HLMdiag) 
library(texreg)
library(optimx)
library(gt)
# Some diagnostic graphics for hlm
```

```{r, load_data}
MCDI <- as_tibble(read_csv("|4|MCDI_CHILDES.csv"))
```

```{r, refactor/clean}
ages <- c(18,21,24,27,30)
categorical <- c("Age","Word","Lexical_Class","Produce")
continuous <- c("original_freq","original_ld","original_dd","original_pkc")

produce_data <- MCDI %>% select(Subject,Word,Age,Produce,Lexical_Class,
                         original_freq,original_ld,original_dd,original_pkc) %>% 
                  filter(Age %in% ages)

produce_data[categorical] <- lapply(produce_data[categorical], factor)

# frequency is -Inf for skate at 18mo, remove.
produce_data <- produce_data %>% filter(Word != "skate")
```

# Z-standardization and centering of continous varibles 

```{r, create scaled variables}
produce_data_scaled <- produce_data %>% mutate(s_original_freq = 
                                                 scale(original_freq),
                                        s_original_ld = scale(original_ld),
                                        s_original_dd = scale(original_dd),
                                        s_original_pkc = scale(original_pkc))

# frequency is -Inf for skate at 18mo after log10 transformation remove.
produce_data <- produce_data %>% filter(Word != "skate")
```

The goal of the current analysis is to predict individual word 
production data (i.e parental report) from statistical predictors derived from
language corpora (CHILDES). The approach we will take in this analysis is to 
build from a simple to maximal model.

# Empty models (1 random effect)
The first 3 models we will consider include only random effects, one model for 
each grouping factor within the dataset (Subject,Word,Age). Doing so will allow 
us to assess how much variance each explains. Specifically we will compare each 
model using the coefficient of determination (R2).

## model1: Produce ~ (1|Subject)
```{r, empty_model1}
# empty_model1
model1 <- glmer(Produce ~ (1|Subject), data = produce_data_scaled ,
                      family = "binomial")

# check empty_model1 summary
model1_summary <- summary(model1)

# check empty_model1 performance
model1_performance <- model_performance(model1) %>% gt()  %>% 
  tab_header(title = "Empty Model 1",subtitle = "produce ~ (1|Subject)")
     
# save model1 summary and performance
save(model1, file = "|6|model1.Rdata")
save(model1_summary, file = "|6|model1_summary.Rdata")
save(model1_performance, file = "|6|model1_performance.Rdata")
```

## model2: Produce ~ (1|Word)
```{r, empty_model2}
# empty_model2
model2 <- glmer(Produce ~ (1|Word), data = produce_data_scaled ,
                      family = "binomial")

# check empty_model2 summary
model2_summary <- summary(model2)

# check empty_model2 performance
model2_performance <- model_performance(model2) %>% gt()  %>% 
  tab_header(title = "Empty Model 2",subtitle = "produce ~ (1|Word)")
     
# save model2 summary and performance
save(model2, file = "|6|model2.Rdata")
save(model2_summary, file = "|6|model2_summary.Rdata")
save(model2_performance, file = "|6|model2_performance.Rdata")
```

## model3: Produce ~ (1|Age)
```{r}
# empty_model3
model3 <- glmer(Produce ~ (1|Age), data = produce_data_scaled ,
                      family = "binomial")

# check empty_model3 summary
model3_summary <- summary(model3)

# check empty_model3 performance
model3_performance <- model_performance(model3) %>% gt()  %>% 
  tab_header(title = "Empty Model 3",subtitle = "produce ~ (1|Age)")
     
# save model3 summary and performance
save(model3, file = "|6|model3.Rdata")
save(model3_summary, file = "|6|model3_summary.Rdata")
save(model3_performance, file = "|6|model3_performance.Rdata")
```

### Compare empty models with single random effects
```{r compare empty model 1,2 and 3}
compare_single_empty<- compare_performance(model1, model2, 
                                                model3) %>% gt()  %>% 
  tab_header(title = "Compare empty models with single random effect",
             subtitle = "model1 : Produce ~ (1|Subject) 
                         model2 : Produce ~ (1|Word),
                         model3 : Produce ~ (1|Age)")

save(compare_single_empty, file = "|6|Compare empty models with single random 
                                    effect.Rdata")

compare_single_empty
```
The above table indicates the amount of variance explained by each grouping 
factor. This initial comparison allows us to rank models based on amount of
variance in word production explained (i.e 1.-Subject , 2.-Word , 3.-Age)
# Empty models (2 random effects)
We can then ask to what extent do these grouping factors account for unique 
variance as opposed to shared. We account for this by comparing a 
model with just *Subjects* as a random effect and see how adding *Word* and 
*Age* changes the R2.

## model4: Produce ~ (1|Subject) + (1|Word)
```{r}
# model4
model4 <- glmer(Produce ~ (1|Subject) + (1|Word), 
                      data = produce_data_scaled,
                      family = "binomial")

# check model4 summary
model4_summary <- summary(model4)

# check model4 performance
model4_performance <- model_performance(model4) %>% gt()  %>% 
  tab_header(title = "Empty Model 4",subtitle = "produce ~ (1|Subject) + 
                                                           (1|Word)")
     
# save model4 summary and performance
save(model4, file = "|6|model4.Rdata")
save(model4_summary, file = "|6|model4_summary.Rdata")
save(model4_performance, file = "|6|model4_performance.Rdata")
```

## model5: Produce ~ (1|Subject) + (1|Age)
```{r}
# model5
model5 <- glmer(Produce ~ (1|Subject) + (1|Age), 
                      data = produce_data_scaled,
                      family = "binomial")

# check model5 summary
model5_summary <- summary(model5)

# check model5 performance
model5_performance <- model_performance(model5) %>% gt()  %>% 
  tab_header(title = "Empty Model 5",subtitle = "produce ~ (1|Subject) + 
                                                           (1|Age)")
     
# save model5 summary and performance
save(model5, file = "|6|model5.Rdata")
save(model5_summary, file = "|6|model5_summary.Rdata")
save(model5_performance, file = "|6|model5_performance.Rdata")
```

## model6: Produce ~ (1|Age) + (1|Word)
```{r}
# model6
model6 <- glmer(Produce ~ (1|Age) + (1|Word), 
                      data = produce_data_scaled,
                      family = "binomial")

# check model6 summary
model6_summary <- summary(model6)

# check model6 performance
model6_performance <- model_performance(model6) %>% gt()  %>% 
  tab_header(title = "Empty Model 6",subtitle = "produce ~ (1|Age) + 
                                                           (1|Word)")
     
# save model6 summary and performance
save(model6, file = "|6|model6.Rdata")
save(model6_summary, file = "|6|model6_summary.Rdata")
save(model6_performance, file = "|6|model6_performance.Rdata")
```

### Compare empty models with two random effects
```{r compare empty model 1,2 and 3}
compare_two_empty<- compare_performance(model4, model5, 
                                                model6) %>% gt() %>% 
  tab_header(title = "Compare empty models with single random effect",
             subtitle = "model4 : Produce ~ (1|Subject) + (1|Word)
                         model5 : Produce ~ (1|Subject) + (1|Age),
                         model6 : Produce ~ (1|Age) + (1|Word)")

save(compare_two_empty, file = "|6|Compare empty models with two random 
                                    effects.Rdata")
```

Empty model (3 random effects)
## model7: Produce ~ (1|Subject) + (1|Word) + (1|Age)
```{r}
# model7
model7 <- glmer(Produce ~ (1|Subject) + (1|Word) + (1|Age), 
                      data = produce_data_scaled,
                      family = "binomial")

# check model7 summary
model7_summary <- summary(model7)

# check model7 performance
model7_performance <- model_performance(model7) %>% gt()  %>% 
  tab_header(title = "Empty Model 7",subtitle = "produce ~ (1|Subject) + 
                                                           (1|Word) + 
                                                           (1|Age)")
     
# save model7 summary and performance
save(model7, file = "|6|model7.Rdata")
save(model7_summary, file = "|6|model7_summary.Rdata")
save(model7_performance, file = "|6|model7_performance.Rdata")
```
Comparing Model 7 to Model 4 shows that the addition of Age as a grouping factor
does not improve model fit substantially: \newline 
(model4 R2 = 0.7782681 ; model7 R2 = 0.7794932) , given the importance of 
accounting for the grouping factors of *Subject* and *Word*, all subsequent 
models will include each as random effects.
# Single Predictor Models
## 18 
## model8.0: Produce ~ Frequency + (1|Subject) + (1|Word)
```{r}
# model8.0
model8.0 <- glmer(Produce ~ s_original_freq + (1|Subject) + (1|Word), 
                      data = produce_data_scaled %>% filter(Age == "18"),
                          family = "binomial")
                      
                                          

# check model8.0 summary
model8.0_summary <- summary(model8.0)

# check model8.0 performance
model8.0_performance <- model_performance(model8.0) %>% gt()  %>% 
  tab_header(title = "Frequency model 18 months",subtitle = "produce ~ Frequency +
                                                            (1|Subject) + 
                                                            (1|Word) 
                                                            ")
     
# save model8.0 summary and performance
save(model8.0, file = "|6|model8.0.Rdata")
save(model8.0_summary, file = "|6|model8.0_summary.Rdata")
save(model8.0_performance, file = "|6|model8.0_performance.Rdata")

```

## model8.1: Produce ~ Lex_Diversity + (1|Subject) + (1|Word)
```{r}
# model8.1
model8.1 <- glmer(Produce ~ s_original_ld + (1|Subject) + (1|Word), 
                      data = produce_data_scaled %>% filter(Age == "18"),
                          family = "binomial")
                      
                                          

# check model8.1 summary
model8.1_summary <- summary(model8.1)

# check model8.1 performance
model8.1_performance <- model_performance(model8.1) %>% gt()  %>% 
  tab_header(title = "Lex_Diversity model 18 months",subtitle = "produce ~ Lex_Diversity +
                                                            (1|Subject) + 
                                                            (1|Word) 
                                                            ")
     
# save model8.1 summary and performance
save(model8.1, file = "|6|model8.1.Rdata")
save(model8.1_summary, file = "|6|model8.1_summary.Rdata")
save(model8.1_performance, file = "|6|model8.1_performance.Rdata")
```

## model8.2: Produce ~ Doc_Diversity + (1|Subject) + (1|Word)
```{r}
# model8.2
model8.2 <- glmer(Produce ~ s_original_dd + (1|Subject) + (1|Word), 
                      data = produce_data_scaled %>% filter(Age == "18"),
                          family = "binomial")
                      
                                          

# check model8.2 summary
model8.2_summary <- summary(model8.2)

# check model8.2 performance
model8.2_performance <- model_performance(model8.2) %>% gt()  %>% 
  tab_header(title = "Doc_Diversity model 18 months",subtitle = "produce ~ Doc_Diversity +
                                                            (1|Subject) + 
                                                            (1|Word) 
                                                            ")
     
# save model8.2 summary and performance
save(model8.2, file = "|6|model8.2.Rdata")
save(model8.2_summary, file = "|6|model8.2_summary.Rdata")
save(model8.2_performance, file = "|6|model8.2_performance.Rdata")
```

## model8.3: Produce ~ Pro-KWo + (1|Subject) + (1|Word)
```{r}
# model8.3
model8.3 <- glmer(Produce ~ s_original_pkc + (1|Subject) + (1|Word), 
                      data = produce_data_scaled %>% filter(Age == "18"),
                          family = "binomial")
                      
                                          

# check model8.3 summary
model8.3_summary <- summary(model8.3)

# check model8.3 performance
model8.3_performance <- model_performance(model8.3) %>% gt()  %>% 
  tab_header(title = "Pro-KWo model 18 months",subtitle = "produce ~ Pro-KWo +
                                                            (1|Subject) + 
                                                            (1|Word) 
                                                            ")
     
# save model8.3 summary and performance
save(model8.3, file = "|6|model8.3.Rdata")
save(model8.3_summary, file = "|6|model8.3_summary.Rdata")
save(model8.3_performance, file = "|6|model8.3_performance.Rdata")
```

### Compare single predictor models with two random effects
```{r compare empty model 1,2 and 3}
compare_18_models<- compare_performance(model8.0, model8.1, 
                                        model8.2,model8.3) %>% 
  gt() %>% 
  tab_header(title = "Compare empty models with single random effect",
             subtitle = "model8.0 : Produce ~ Frequency + (1|Subject) + (1|Word)
                         model8.1 : Produce ~ Lex_Diversity + (1|Subject) + (1|Word),
                         model8.2 : Produce ~ Doc_Diversity + (1|Subject) + (1|Word),
                         model8.3 : Produce ~ Pro-KWo + (1|Subject) + (1|Word)")

save(compare_18_models, file = "|6|Compare 18 month single models.Rdata")
```


## 21                                          
## model9.0: Produce ~ Frequency + (1|Subject) + (1|Word)
```{r}
# model9.0
model9.0 <- glmer(Produce ~ s_original_freq + (1|Subject) + (1|Word), 
                      data = produce_data_scaled %>% filter(Age == "21"),
                          family = "binomial")
                      
                                          

# check model9.0 summary
model9.0_summary <- summary(model9.0)
# check model9.0 performance
model9.0_performance <- model_performance(model9.0) %>% gt()  %>% 
  tab_header(title = "Frequency model 21 months",subtitle = "produce ~ Frequency +
                                                            (1|Subject) + 
                                                            (1|Word) 
                                                            ")
     
# save model9.0 summary and performance
save(model9.0, file = "|6|model9.0.Rdata")
save(model9.0_summary, file = "|6|model9.0_summary.Rdata")
save(model9.0_performance, file = "|6|model9.0_performance.Rdata")
```

## model9.1: Produce ~ Lex_Diversity + (1|Subject) + (1|Word)
```{r}
# model9.1
model9.1 <- glmer(Produce ~ s_original_ld + (1|Subject) + (1|Word), 
                      data = produce_data_scaled %>% filter(Age == "21"),
                          family = "binomial")
                      
                                          

# check model9.1 summary
model9.1_summary <- summary(model9.1)

# check model9.1 performance
model9.1_performance <- model_performance(model9.1) %>% gt()  %>% 
  tab_header(title = "Lex_Diversity model 21 months",subtitle = "produce ~ Lex_Diversity +
                                                            (1|Subject) + 
                                                            (1|Word) 
                                                            ")
     
# save model9.1 summary and performance
save(model9.1, file = "|6|model9.1.Rdata")
save(model9.1_summary, file = "|6|model9.1_summary.Rdata")
save(model9.1_performance, file = "|6|model9.1_performance.Rdata")
```

## model9.2: Produce ~ Doc_Diversity + (1|Subject) + (1|Word)
```{r}
# model9.2
model9.2 <- glmer(Produce ~ s_original_dd + (1|Subject) + (1|Word), 
                      data = produce_data_scaled %>% filter(Age == "21"),
                          family = "binomial")
                      
                                          

# check model9.2 summary
model9.2_summary <- summary(model9.2)

# check model9.2 performance
model9.2_performance <- model_performance(model9.2) %>% gt()  %>% 
  tab_header(title = "Doc_Diversity model 21 months",subtitle = "produce ~ Doc_Diversity +
                                                            (1|Subject) + 
                                                            (1|Word) 
                                                            ")
     
# save model9.2 summary and performance
save(model9.2, file = "|6|model9.2.Rdata")
save(model9.2_summary, file = "|6|model9.2_summary.Rdata")
save(model9.2_performance, file = "|6|model9.2_performance.Rdata")
```

## model9.3: Produce ~ Pro-KWo + (1|Subject) + (1|Word)
```{r}
# model9.3
model9.3 <- glmer(Produce ~ s_original_pkc + (1|Subject) + (1|Word), 
                      data = produce_data_scaled %>% filter(Age == "21"),
                          family = "binomial")
                      
                                          

# check model9.3 summary
model9.3_summary <- summary(model9.3)

# check model9.3 performance
model9.3_performance <- model_performance(model9.3) %>% gt()  %>% 
  tab_header(title = "Pro-KWo model 21 months",subtitle = "produce ~ Pro-KWo +
                                                            (1|Subject) + 
                                                            (1|Word) 
                                                            ")
     
# save model9.3 summary and performance
save(model9.3, file = "|6|model9.3.Rdata")
save(model9.3_summary, file = "|6|model9.3_summary.Rdata")
save(model9.3_performance, file = "|6|model9.3_performance.Rdata")
```


### Compare single predictor models with two random effects 
```{r compare empty model 1,2 and 3}
compare_21_models<- compare_performance(model9.0, model9.1, 
                                        model9.2,model9.3) %>% 
  gt() %>% 
  tab_header(title = "Compare empty models with single random effect",
             subtitle = "model9.0 : Produce ~ Frequency + (1|Subject) + (1|Word)
                         model9.1 : Produce ~ Lex_Diversity + (1|Subject) + (1|Word),
                         model9.2 : Produce ~ Doc_Diversity + (1|Subject) + (1|Word),
                         model9.3 : Produce ~ Pro-KWo + (1|Subject) + (1|Word)")

save(compare_21_models, file = "|6|Compare 21 month single models.Rdata")
```

## 24
## model10.0: Produce ~ Frequency + (1|Subject) + (1|Word)
```{r}
# model10.0
model10.0 <- glmer(Produce ~ s_original_freq + (1|Subject) + (1|Word), 
                      data = produce_data_scaled %>% filter(Age == "24"),
                          family = "binomial")
                      
                                          

# check model10.0 summary
model10.0_summary <- summary(model10.0)

# check model10.0 performance
model10.0_performance <- model_performance(model10.0) %>% gt()  %>% 
  tab_header(title = "Frequency model 24 months",subtitle = "produce ~ Frequency +
                                                            (1|Subject) + 
                                                            (1|Word) 
                                                            ")
     
# save model10.0 summary and performance
save(model10.0, file = "|6|model10.0.Rdata")
save(model10.0_summary, file = "|6|model10.0_summary.Rdata")
save(model10.0_performance, file = "|6|model10.0_performance.Rdata")
```

## model10.1: Produce ~ Lex_Diversity + (1|Subject) + (1|Word)
```{r}
# model10.1
model10.1 <- glmer(Produce ~ s_original_ld + (1|Subject) + (1|Word), 
                      data = produce_data_scaled %>% filter(Age == "24"),
                          family = "binomial")
                      
                                          

# check model10.1 summary
model10.1_summary <- summary(model10.1)

# check model10.1 performance
model10.1_performance <- model_performance(model10.1) %>% gt()  %>% 
  tab_header(title = "Lex_Diversity model 24 months",subtitle = "produce ~ Lex_Diversity +
                                                            (1|Subject) + 
                                                            (1|Word) 
                                                            ")
     
# save model10.1 summary and performance
save(model10.1, file = "|6|model10.1.Rdata")
save(model10.1_summary, file = "|6|model10.1_summary.Rdata")
save(model10.1_performance, file = "|6|model10.1_performance.Rdata")
```

## model10.2: Produce ~ Doc_Diversity + (1|Subject) + (1|Word)
```{r}
# model10.2
model10.2 <- glmer(Produce ~ s_original_dd + (1|Subject) + (1|Word), 
                      data = produce_data_scaled %>% filter(Age == "24"),
                          family = "binomial")
                      
                                          

# check model10.2 summary
model10.2_summary <- summary(model10.2)

# check model10.2 performance
model10.2_performance <- model_performance(model10.2) %>% gt()  %>% 
  tab_header(title = "Doc_Diversity model 24 months",subtitle = "produce ~ Doc_Diversity +
                                                            (1|Subject) + 
                                                            (1|Word) 
                                                            ")
     
# save model10.2 summary and performance
save(model10.2, file = "|6|model10.2.Rdata")
save(model10.2_summary, file = "|6|model10.2_summary.Rdata")
save(model10.2_performance, file = "|6|model10.2_performance.Rdata")
```

## model10.3: Produce ~ Pro-KWo + (1|Subject) + (1|Word)
```{r}
# model10.3
model10.3 <- glmer(Produce ~ s_original_pkc + (1|Subject) + (1|Word), 
                      data = produce_data_scaled %>% filter(Age == "24"),
                          family = "binomial")
                      
                                          

# check model10.3 summary
model10.3_summary <- summary(model10.3)

# check model10.3 performance
model10.3_performance <- model_performance(model10.3) %>% gt()  %>% 
  tab_header(title = "Pro-KWo model 24 months",subtitle = "produce ~ Pro-KWo +
                                                            (1|Subject) + 
                                                            (1|Word) 
                                                            ")
     
# save model10.3 summary and performance
save(model10.3, file = "|6|model10.3.Rdata")
save(model10.3_summary, file = "|6|model10.3_summary.Rdata")
save(model10.3_performance, file = "|6|model10.3_performance.Rdata")
```

### Compare single predictor models with two random effects 
```{r compare empty model 1,2 and 3}
compare_24_models<- compare_performance(model10.0, model10.1, 
                                        model10.2,model10.3) %>% 
  gt() %>% 
  tab_header(title = "Compare empty models with single random effect",
             subtitle = "model10.0 : Produce ~ Frequency + (1|Subject) + (1|Word)
                         model10.1 : Produce ~ Lex_Diversity + (1|Subject) + (1|Word),
                         model10.2 : Produce ~ Doc_Diversity + (1|Subject) + (1|Word),
                         model10.3 : Produce ~ Pro-KWo + (1|Subject) + (1|Word)")

save(compare_24_models, file = "|6|Compare 24 month single models.Rdata")
```


## 27 
## model11.0: Produce ~ Frequency + (1|Subject) + (1|Word)
```{r}
# model11.0
model11.0 <- glmer(Produce ~ s_original_freq + (1|Subject) + (1|Word), 
                      data = produce_data_scaled %>% filter(Age == "27"),
                          family = "binomial")
                      
                                          

# check model11.0 summary
model11.0_summary <- summary(model11.0)

# check model11.0 performance
model11.0_performance <- model_performance(model11.0) %>% gt()  %>% 
  tab_header(title = "Frequency model 27 months",subtitle = "produce ~ Frequency +
                                                            (1|Subject) + 
                                                            (1|Word) 
                                                            ")
     
# save model11.0 summary and performance
save(model11.0, file = "|6|model11.0.Rdata")
save(model11.0_summary, file = "|6|model11.0_summary.Rdata")
save(model11.0_performance, file = "|6|model11.0_performance.Rdata")
```

## model11.1: Produce ~ Lex_Diversity + (1|Subject) + (1|Word)
```{r}
# model11.1
model11.1 <- glmer(Produce ~ s_original_ld + (1|Subject) + (1|Word), 
                      data = produce_data_scaled %>% filter(Age == "27"),
                          family = "binomial")
                      
                                          

# check model11.1 summary
model11.1_summary <- summary(model11.1)

# check model11.1 performance
model11.1_performance <- model_performance(model11.1) %>% gt()  %>% 
  tab_header(title = "Lex_Diversity model 27 months",subtitle = "produce ~ Lex_Diversity +
                                                            (1|Subject) + 
                                                            (1|Word) 
                                                            ")
     
# save model11.1 summary and performance
save(model11.1, file = "|6|model11.1.Rdata")
save(model11.1_summary, file = "|6|model11.1_summary.Rdata")
save(model11.1_performance, file = "|6|model11.1_performance.Rdata")
```

## model11.2: Produce ~ Doc_Diversity + (1|Subject) + (1|Word)
```{r}
# model11.2
model11.2 <- glmer(Produce ~ s_original_dd + (1|Subject) + (1|Word), 
                      data = produce_data_scaled %>% filter(Age == "27"),
                          family = "binomial")
                      
                                          

# check model11.2 summary
model11.2_summary <- summary(model11.2)

# check model11.2 performance
model11.2_performance <- model_performance(model11.2) %>% gt()  %>% 
  tab_header(title = "Doc_Diversity model 27 months",subtitle = "produce ~ Doc_Diversity +
                                                            (1|Subject) + 
                                                            (1|Word) 
                                                            ")
     
# save model11.2 summary and performance
save(model11.2, file = "|6|model11.2.Rdata")
save(model11.2_summary, file = "|6|model11.2_summary.Rdata")
save(model11.2_performance, file = "|6|model11.2_performance.Rdata")
```

## model11.3: Produce ~ Pro-KWo + (1|Subject) + (1|Word)
```{r}
# model11.3
model11.3 <- glmer(Produce ~ s_original_pkc + (1|Subject) + (1|Word), 
                      data = produce_data_scaled %>% filter(Age == "27"),
                          family = "binomial")
                      
                                          

# check model11.3 summary
model11.3_summary <- summary(model11.3)

# check model11.3 performance
model11.3_performance <- model_performance(model11.3) %>% gt()  %>% 
  tab_header(title = "Pro-KWo model 27 months",subtitle = "produce ~ Pro-KWo +
                                                            (1|Subject) + 
                                                            (1|Word) 
                                                            ")
     
# save model11.3 summary and performance
save(model11.3, file = "|6|model11.3.Rdata")
save(model11.3_summary, file = "|6|model11.3_summary.Rdata")
save(model11.3_performance, file = "|6|model11.3_performance.Rdata")
```

### Compare single predictor models with two random effects 

```{r compare empty model 1,2 and 3}
compare_27_models<- compare_performance(model11.0, model11.1, 
                                        model11.2,model11.3) %>% 
  gt() %>% 
  tab_header(title = "Compare empty models with single random effect",
             subtitle = "model11.0 : Produce ~ Frequency + (1|Subject) + (1|Word)
                         model11.1 : Produce ~ Lex_Diversity + (1|Subject) + (1|Word),
                         model11.2 : Produce ~ Doc_Diversity + (1|Subject) + (1|Word),
                         model11.3 : Produce ~ Pro-KWo + (1|Subject) + (1|Word)")

save(compare_27_models, file = "|6|Compare 27 month single models.Rdata")
```
## 30 
## model12.0: Produce ~ Frequency + (1|Subject) + (1|Word)

```{r}
# model12.0
model12.0 <- glmer(Produce ~ s_original_freq + (1|Subject) + (1|Word), 
                      data = produce_data_scaled %>% filter(Age == "30"),
                          family = "binomial")
                      
                                          

# check model12.0 summary
model12.0_summary <- summary(model12.0)

# check model12.0 performance
model12.0_performance <- model_performance(model12.0) %>% gt()  %>% 
  tab_header(title = "Frequency model 30 months",subtitle = "produce ~ Frequency +
                                                            (1|Subject) + 
                                                            (1|Word) 
                                                            ")
     
# save model12.0 summary and performance
save(model12.0, file = "|6|model12.0.Rdata")
save(model12.0_summary, file = "|6|model12.0_summary.Rdata")
save(model12.0_performance, file = "|6|model12.0_performance.Rdata")
```

## model12.1: Produce ~ Lex_Diversity + (1|Subject) + (1|Word)
```{r}
# model12.1
model12.1 <- glmer(Produce ~ s_original_ld + (1|Subject) + (1|Word), 
                      data = produce_data_scaled %>% filter(Age == "30"),
                          family = "binomial")
                      
                                          

# check model12.1 summary
model12.1_summary <- summary(model12.1)

# check model12.1 performance
model12.1_performance <- model_performance(model12.1) %>% gt()  %>% 
  tab_header(title = "Lex_Diversity model 30 months",subtitle = "produce ~ Lex_Diversity +
                                                            (1|Subject) + 
                                                            (1|Word) 
                                                            ")
     
# save model12.1 summary and performance
save(model12.1, file = "|6|model12.1.Rdata")
save(model12.1_summary, file = "|6|model12.1_summary.Rdata")
save(model12.1_performance, file = "|6|model12.1_performance.Rdata")
```

## model12.2: Produce ~ Doc_Diversity + (1|Subject) + (1|Word)
```{r}
# model12.2
model12.2 <- glmer(Produce ~ s_original_dd + (1|Subject) + (1|Word), 
                      data = produce_data_scaled %>% filter(Age == "30"),
                          family = "binomial")
                      
                                          

# check model12.2 summary
model12.2_summary <- summary(model12.2)

# check model12.2 performance
model12.2_performance <- model_performance(model12.2) %>% gt()  %>% 
  tab_header(title = "Doc_Diversity model 30 months",subtitle = "produce ~ Doc_Diversity +
                                                            (1|Subject) + 
                                                            (1|Word) 
                                                            ")
     
# save model12.2 summary and performance
save(model12.2, file = "|6|model12.2.Rdata")
save(model12.2_summary, file = "|6|model12.2_summary.Rdata")
save(model12.2_performance, file = "|6|model12.2_performance.Rdata")
```

## model12.3: Produce ~ Pro-KWo + (1|Subject) + (1|Word)
```{r}
# model12.3
model12.3 <- glmer(Produce ~ s_original_pkc + (1|Subject) + (1|Word), 
                      data = produce_data_scaled %>% filter(Age == "30"),
                          family = "binomial")
                      
                                          

# check model12.3 summary
model12.3_summary <- summary(model12.3)

# check model12.3 performance
model12.3_performance <- model_performance(model12.3) %>% gt()  %>% 
  tab_header(title = "Pro-KWo model 30 months",subtitle = "produce ~ Pro-KWo +
                                                            (1|Subject) + 
                                                            (1|Word) 
                                                            ")
     
# save model12.3 summary and performance
save(model12.3, file = "|6|model12.3.Rdata")
save(model12.3_summary, file = "|6|model12.3_summary.Rdata")
save(model12.3_performance, file = "|6|model12.3_performance.Rdata")
```

### Compare single predictor models with two random effects 

```{r compare empty model 1,2 and 3}
compare_30_models<- compare_performance(model12.0, model12.1, 
                                        model12.2,model12.3) %>% 
  gt() %>% 
  tab_header(title = "Compare empty models with single random effect",
             subtitle = "model12.0 : Produce ~ Frequency + (1|Subject) + (1|Word)
                         model12.1 : Produce ~ Lex_Diversity + (1|Subject) + (1|Word),
                         model12.2 : Produce ~ Doc_Diversity + (1|Subject) + (1|Word),
                         model12.3 : Produce ~ Pro-KWo + (1|Subject) + (1|Word)")

save(compare_30_models, file = "|6|Compare 30 month single models.Rdata")
```

# All Predictor Models 
## 18
## model13: Produce ~ Frequency + Lex_Diversity + Doc_Diversity + Pro-KWo + (1|Subject) + (1|Word) 
```{r}
# model13
model13 <- glmer(Produce ~ s_original_freq + s_original_ld + s_original_dd +
                   s_original_pkc + (1|Subject) + (1|Word),
                      data = produce_data_scaled %>% filter(Age == "18"),
                          family = "binomial")
                      
                                          

# check model13 summary
model13_summary <- summary(model13)

# check model13 performance
model13_performance <- model_performance(model13) %>% gt()  %>% 
  tab_header(title = "All Predictor model 18.Rdata",subtitle = "produce ~ Frequency +
                                                            Lex_Diversity +
                                                            Doc_Diveristy +
                                                            Pro-KWo +
                                                            (1|Subject) + 
                                                            (1|Word) 
                                                            ")
     
# save model13 summary and performance
save(model13, file = "|6|model13.Rdata")
save(model13_summary, file = "|6|model13_summary.Rdata")
save(model13_performance, file = "|6|model13_performance.Rdata")
```

## 21
## model14: Produce ~ Frequency + Lex_Diversity + Doc_Diversity + Pro-KWo + (1|Subject) + (1|Word) 
```{r}
# model14
model14 <- glmer(Produce ~ s_original_freq + s_original_ld + s_original_dd +
                   s_original_pkc + (1|Subject) + (1|Word),
                      data = produce_data_scaled %>% filter(Age == "21"),
                          family = "binomial")
                      
                                          

# check model14 summary
model14_summary <- summary(model14)

# check model14 performance
model14_performance <- model_performance(model14) %>% gt()  %>% 
  tab_header(title = "All Predictor model 21.Rdata",subtitle = "produce ~ Frequency +
                                                            Lex_Diversity +
                                                            Doc_Diveristy +
                                                            Pro-KWo +
                                                            (1|Subject) + 
                                                            (1|Word) 
                                                            ")
     
# save model14 summary and performance
save(model14, file = "|6|model14.Rdata")
save(model14_summary, file = "|6|model14_summary.Rdata")
save(model14_performance, file = "|6|model14_performance.Rdata")
```

## 24
## model15: Produce ~ Frequency + Lex_Diversity + Doc_Diversity + Pro-KWo + (1|Subject) + (1|Word) 
```{r}
# model15
model15 <- glmer(Produce ~ s_original_freq + s_original_ld + s_original_dd +
                   s_original_pkc + (1|Subject) + (1|Word),
                      data = produce_data_scaled %>% filter(Age == "24"),
                          family = "binomial")
                      
                                          

# check model15 summary
model15_summary <- summary(model15)

# check model15 performance
model15_performance <- model_performance(model15) %>% gt()  %>% 
  tab_header(title = "All Predictor model 24.Rdata",subtitle = "produce ~ Frequency +
                                                            Lex_Diversity +
                                                            Doc_Diveristy +
                                                            Pro-KWo +
                                                            (1|Subject) + 
                                                            (1|Word) 
                                                            ")
     
# save model15 summary and performance
save(model15, file = "|6|model15.Rdata")
save(model15_summary, file = "|6|model15_summary.Rdata")
save(model15_performance, file = "|6|model15_performance.Rdata")
```

## 27
## model16: Produce ~ Frequency + Lex_Diversity + Doc_Diversity + Pro-KWo + (1|Subject) + (1|Word) 
```{r}
# model16
model16 <- glmer(Produce ~ s_original_freq + s_original_ld + s_original_dd +
                   s_original_pkc + (1|Subject) + (1|Word),
                      data = produce_data_scaled %>% filter(Age == "27"),
                          family = "binomial")
                      
                                          

# check model16 summary
model16_summary <- summary(model16)

# check model16 performance
model16_performance <- model_performance(model16) %>% gt()  %>% 
  tab_header(title = "All Predictor model 27.Rdata",subtitle = "produce ~ Frequency +
                                                            Lex_Diversity +
                                                            Doc_Diveristy +
                                                            Pro-KWo +
                                                            (1|Subject) + 
                                                            (1|Word) 
                                                            ")
     
# save model16 summary and performance
save(model16, file = "|6|model16.Rdata")
save(model16_summary, file = "|6|model16_summary.Rdata")
save(model16_performance, file = "|6|model16_performance.Rdata")
```

## 30
## model17: Produce ~ Frequency + Lex_Diversity + Doc_Diversity + Pro-KWo + (1|Subject) + (1|Word)
```{r}
# model17
model17 <- glmer(Produce ~ s_original_freq + s_original_ld + s_original_dd +
                   s_original_pkc + (1|Subject) + (1|Word),
                      data = produce_data_scaled %>% filter(Age == "30"),
                          family = "binomial")
                      
                                          

# check model17 summary
model17_summary <- summary(model17)

# check model17 performance
model17_performance <- model_performance(model17) %>% gt()  %>% 
  tab_header(title = "All Predictor model 30.Rdata",subtitle = "produce ~ Frequency +
                                                            Lex_Diversity +
                                                            Doc_Diveristy +
                                                            Pro-KWo +
                                                            (1|Subject) + 
                                                            (1|Word) 
                                                            ")
     
# save model17 summary and performance
save(model17, file = "|6|model17.Rdata")
save(model17_summary, file = "|6|model17_summary.Rdata")
save(model17_performance, file = "|6|model17_performance.Rdata")
```




```{r save as group}
save(model8.0,model8.0_summary,model8.0_performance,
     model8.1,model8.1_summary,model8.1_performance,
     model8.2,model8.2_summary,model8.2_performance,
     model8.3,model8.3_summary,model8.3_performance,
     model9.0,model9.0_summary,model9.0_performance,
     model9.1,model9.1_summary,model9.1_performance,
     model9.2,model9.2_summary,model9.2_performance,
     model9.3,model9.3_summary,model9.3_performance,
     model10.0,model10.0_summary,model10.0_performance,
     model10.1,model10.1_summary,model10.1_performance,
     model10.2,model10.2_summary,model10.2_performance,
     model10.3,model10.3_summary,model10.3_performance,
     model11.0,model11.0_summary,model11.0_performance,
     model11.1,model11.1_summary,model11.1_performance,
     model11.2,model11.2_summary,model11.2_performance,
     model11.3,model11.3_summary,model11.3_performance,
     model12.0,model12.0_summary,model12.0_performance,
     model12.1,model12.1_summary,model12.1_performance,
     model12.2,model12.2_summary,model12.2_performance,
     model12.3,model12.3_summary,model12.3_performance, 
     file = "|6|Single Predictor Models.Rdata")
```

```{r}
save(model13,model13_summary,model13_performance,
     model14,model14_summary,model14_performance,
     model15,model15_summary,model15_performance,
     model16,model16_summary,model16_performance,
     model17,model17_summary,model17_performance, 
     file = "|6|All Predictor Models.Rdata")
```




















# THE END